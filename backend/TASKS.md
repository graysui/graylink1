# GrayLink 后端修复任务清单

## ⚠️ 重要提示：目录完整性检查

在开始任何修改之前，必须完成以下目录检查清单：

```
backend/app/
├── core/      [  ] 核心功能模块
│   ├── base.py        
│   ├── database.py    
│   ├── session.py     
│   ├── config.py      
│   ├── cache.py       
│   └── security.py    
│
├── handlers/  [ ] API 处理器
│   ├── auth.py
│   ├── monitor.py
│   └── ...
│
├── models/    [✓] 数据模型
│   ├── user.py
│   └── ...
│
├── modules/   [✓] 核心业务逻辑
│   ├── monitor/   ✓ 监控模块
│   │   ├── models.py
│   │   ├── scanner.py
│   │   ├── service.py
│   │   └── events.py
│   ├── symlink/   ✓ 软链接模块
│   │   └── manager.py
│   ├── emby/      - Emby集成
│   │   ├── client.py
│   │   └── service.py
│   └── database/  ✓ 数据库管理
│       └── manager.py
│
├── schemas/   [ ] 数据验证
│
└── utils/     [ ] 工具函数
```

### 目录检查要求

1. 每次修改前：
   - 完整遍历所有目录
   - 特别关注 modules 目录
   - 检查模块间的依赖关系

2. 修改时注意：
   - 确保修改不影响 modules 中的业务逻辑
   - 验证所有相关模块的功能
   - 保持模块间接口的一致性

3. 修改后确认：
   - 重新检查所有目录
   - 验证业务模块的完整性
   - 测试模块间的交互

## 注意事项

1. 前后端兼容性
   - 确保所有修改不影响前端接口
   - 保持 API 响应格式不变
   - 维持现有的 API 路由和参数
   - 不要要求前端做任何修改

2. 功能完整性
   - 保持所有现有功能的完整性
   - 不随意删除任何功能代码
   - 修改前确保完全理解代码作用
   - 记录所有功能点确保全部保留

3. 代码依赖管理
   - 删除代码前全面评估影响范围
   - 检查代码间的调用关系
   - 确保相关模块的功能正常
   - 维护必要的代码注释

4. 整体性原则
   - 以整个后端为整体考虑修改
   - 同步修改所有相关联模块
   - 确保修改后系统可以完整运行
   - 避免孤立修改单个模块

5. 代码修改原则
   - 保持向后兼容
   - 最小化修改范围
   - 确保测试覆盖

6. 依赖处理
   - 避免循环导入
   - 明确模块职责

7. 测试要求
   - 每个修改都需要测试
   - 确保不破坏现有功能
   - 验证性能影响

8. 文档维护
   - 及时更新文档
   - 添加注释说明
   - 记录重要决策


